<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Entrar</title>
</head>

<body>

    <h1>Entrar</h1>
    <form id="login-form">
        <label for="email">Email:</label>
        <input type="email" id="email" name="email" required>

        <label for="password">Senha:</label>
        <input type="password" id="password" name="password" required>

        <button type="submit">Entrar</button>
    </form>

    <button id="logout-button" style="display: none;">Sair</button>

    <script type="module">

        import firebaseConfig from "../../../../firebaseConfig.js";

        // Import the functions you need from the SDKs you need
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.10.0/firebase-app.js";
        // Importação do criar usuário com e-mail e senha e fazer login como e-mail e senha.
        import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/10.10.0/firebase-auth.js";
        // TODO: Add SDKs for Firebase products that you want to use
        // https://firebase.google.com/docs/web/setup#available-libraries

        const firebaseApp = initializeApp(firebaseConfig);
        const firebaseAuth = getAuth(firebaseApp);

        // O usuário está logado?
        firebaseAuth.onAuthStateChanged((user) => {
            if (user) {
                // O usuário vai ir para a página hommee se ele estiver logado.
                window.location.replace("/homee.html");
            }
        });

        let loginForm = document.getElementById('login-form');
        loginForm.addEventListener('submit', (event) => {
            event.preventDefault();
            let email = loginForm['email'].value;
            let password = loginForm['password'].value;
            signInWithEmailAndPassword(firebaseAuth, email, password)
                .then((userCredential) => {
                    const user = userCredential.user;
                    console.log('Usuário logado:', user);
                })
                .catch((error) => {
                    const errorCode = error.code;
                    const errorMessage = error.message;
                    console.error('Erro ao fazer login:', errorMessage);
                    alert('E-mail e senha incorretos!');
                });
        });
    </script>

</body>

</html>